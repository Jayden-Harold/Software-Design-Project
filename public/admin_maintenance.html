<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="admin_maintenance.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Smoke</title>
    <script src="https://kit.fontawesome.com/4b08f514fc.js" crossorigin="anonymous"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="admin_maintenance.js" defer type="module"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script>
      function downloadPDF() {
        const element = document.getElementById('maintenance');
        html2pdf().from(element).save('maintenance.pdf');
      }
    </script>
    <script src="graphing_maintenance.js" defer type="module"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
         <script>
        const apiKey = '5a3c0823d180bfaf64e493bab38442f5'; // Replace with your OpenWeatherMap API key
        const city = 'Johannesburg'; // Replace with your city

        fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`)
            .then(response => response.json())
            .then(data => {
                const temp = data.main.temp;
                const description = data.weather[0].description;
                const iconCode = data.weather[0].icon;
                const iconUrl = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;

                document.getElementById('weather').innerHTML = `
                    <img src="${iconUrl}" alt="${description}">
                `;
            })
            .catch(error => {
                document.getElementById('weather').innerHTML = 'Unable to fetch weather data.';
                console.error(error);
            });
    </script>
</head>

<header class="nav-container">
    <nav class="nav-bar">
      <img src="images/green-smoke-1.png" id="Logo">
        <ul class="nav-menu">
          <li id="weather"></li>
          <li>
            <a href="admin_dashboard.html" style="font-size: 30px; color: white;">
              <i class="fa fa-tachometer" aria-hidden="true"></i>
            </a>
          </li>
          <li>
            <a href="admin.html" style="font-size: 30px; color: white;">
              <i class="fa fa-home" aria-hidden="true"></i>
            </a>
          </li>     
        </ul>
        <button id="mobile-menu" class="menu-toggle">
          <i class="fa-sharp fa-solid fa-bars fa-2xl" style="color: #EDEDED"></i>
      </button>
    </nav>
    </header>

<body>
  <section id="maintenance">
  <h1>Maintenance</h1>
  <section class="btn-container"><button id="pdf-btn" onclick="downloadPDF()"><i class="fa fa-download" aria-hidden="true"></i> Download as PDF</button></section>
    <section class="Pending">
        <h2>Unassigned Reports</h2>
          <table id="mainTable">
              <thead>
              <tr class="table-headings">
                  <th>Facility Affected</th>
                  <th>Category</th>
                  <th>Description</th>
                  <th>Assigned to:</th>
                  <th>Status</th>        
                  <th>Date Reported</th>        
              </tr>
              </thead>
              <tbody></tbody>
          </table>
        </section>
        <section class="Accepted">
          <h2>Assigned Reports</h2>
          <table id="approvedTable">
            <thead>
            <tr class="table-headings">
              <th>Facility Affected</th>
              <th>Category</th>
              <th>Description</th>
              <th>Assigned to:</th>
              <th>Status</th>        
              <th>Date Reported</th>  
            </tr>
            </thead>
            <tbody></tbody>
        </table>
      </section>
    <section id ="Staff Performance">
      <h1>Staff Performance</h1>
      <table id="staffPerformanceTable">
            <thead>
            <tr class="table-headings">
              <th>Staff Member</th>
              <th>Issues Resolved</th>
              <th>Avg Resolution Time</th>
              <th>Cumulative Workload</th> 
            </tr>
            </thead>
            <tbody></tbody>
        </table> 
    </section>
    </section>
        <section class="issues">
        <h1>Maintenance Summary</h1>
        <select id="dateRangeSelector">
        <option value="7">Last 7 days</option>
        <option value="30">Last 30 days</option>
        </select>
        <h2>Issue Status Overview</h2>
        <section id="chart-container"><canvas id="issueChart" width="400" height="200"></canvas></section>
        <h2>Issues by Facility</h2>
        <section id="chart-container"><canvas id="facilityChart" width="400" height="200"></canvas></section>
    </section>
</body>
  <footer>
    <section>
      <img src="images/green-smoke-2.png" id="foot-img">
      <p>Â© Green Smoke 2025</p>
    </section>
    <section class="contact-us">
      <h3>Contact Us</h3>
      <p>Telephone: (+27) 11 222 3333</p>
      <p>Instagram: @greensmoke</p>
      <p>Email: martin.shilenge@greensmoke.co.za</p>
    </section>
    <section class="green-smoke-foot">
      <h3 id="green-smoke-h3">Green Smoke</h3>
      <p><a href="#" class="f-links">Terms and Conditions</a></p>  
      <p><a href="#" class="f-links">Privacy Policy</a></p>  
    </section>
    </footer>
</html>
